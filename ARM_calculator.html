<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Risk Model Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8fafc;
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 672px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .card-header {
            padding: 24px 24px 0 24px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #1e293b;
        }

        .card-content {
            padding: 24px;
        }

        .space-y-6 > * + * {
            margin-top: 24px;
        }

        .space-y-2 > * + * {
            margin-top: 8px;
        }

        .space-y-4 > * + * {
            margin-top: 16px;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
        }

        .flex {
            display: flex;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-center {
            justify-content: center;
        }

        .items-center {
            align-items: center;
        }

        .gap-4 {
            gap: 16px;
        }

        .text-sm {
            font-size: 14px;
        }

        .text-xl {
            font-size: 20px;
        }

        .font-medium {
            font-weight: 500;
        }

        .font-bold {
            font-weight: 700;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .text-gray-600 {
            color: #6b7280;
        }

        .text-blue-600 {
            color: #2563eb;
        }

        .text-red-600 {
            color: #dc2626;
        }

        .text-yellow-600 {
            color: #d97706;
        }

        .text-green-600 {
            color: #16a34a;
        }

        .bg-gray-100 {
            background-color: #f3f4f6;
        }

        .bg-green-500 {
            background-color: #22c55e;
        }

        .bg-yellow-500 {
            background-color: #eab308;
        }

        .bg-red-500 {
            background-color: #ef4444;
        }

        .min-w-64 {
            min-width: 256px;
        }

        .min-w-96 {
            min-width: 384px;
        }

        .w-full {
            width: 100%;
        }

        .h-4 {
            height: 16px;
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .rounded-lg {
            border-radius: 8px;
        }

        .overflow-hidden {
            overflow: hidden;
        }

        .p-4 {
            padding: 16px;
        }

        .mt-6 {
            margin-top: 24px;
        }

        .transition-all {
            transition: all 0.2s ease;
        }

        .block {
            display: block;
        }

        /* Select Dropdown Styles */
        .select-container {
            position: relative;
        }

        .select-trigger {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 8px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }

        .select-trigger:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
            border-color: #3b82f6;
        }

        /* Slider Styles */
        .slider-container {
            position: relative;
            width: 100%;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e5e7eb;
            outline: none;
            appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            position: relative;
            height: 16px;
            width: 100%;
            background-color: #f3f4f6;
        }

        .progress-fill {
            height: 100%;
            transition: all 0.2s ease;
        }

        @media (max-width: 768px) {
            .min-w-64, .min-w-96 {
                min-width: auto;
            }
            
            .card-content {
                padding: 16px;
            }
            
            .flex {
                flex-direction: column;
                gap: 8px;
            }
            
            .text-right {
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1 class="card-title">Audit Risk Model Calculator</h1>
            </div>
            <div class="card-content space-y-6">
                <!-- Audit Risk Selection -->
                <div class="space-y-2">
                    <label for="auditRisk">Audit Risk</label>
                    <div class="select-container">
                        <select id="auditRisk" class="select-trigger">
                            <option value="0.05">5%</option>
                            <option value="0.10">10%</option>
                        </select>
                    </div>
                </div>

                <!-- Inherent Risk Slider -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <label for="inherentRisk">Inherent Risk</label>
                        <span class="text-sm" id="inherentRiskValue">50.0%</span>
                    </div>
                    <input type="range" id="inherentRisk" class="slider" min="1" max="100" value="50" step="1">
                    <div class="flex gap-4">
                        <div class="progress-bar rounded-full overflow-hidden">
                            <div id="inherentRiskBar" class="progress-fill bg-yellow-500" style="width: 50%"></div>
                        </div>
                    </div>
                </div>

                <!-- Control Risk Slider -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <label for="controlRisk">Control Risk</label>
                        <span class="text-sm" id="controlRiskValue">50.0%</span>
                    </div>
                    <input type="range" id="controlRisk" class="slider" min="1" max="100" value="50" step="1">
                    <div class="flex gap-4 items-center">
                        <div class="progress-bar rounded-full overflow-hidden">
                            <div id="controlRiskBar" class="progress-fill bg-yellow-500" style="width: 50%"></div>
                        </div>
                        <div class="text-sm min-w-96 text-right" id="controlRiskMessage">
                            <span class="font-bold text-yellow-600">MODERATE reliance on controls if tests of operating effectiveness indicate MODERATE level of control risk</span>
                        </div>
                    </div>
                </div>

                <!-- Detection Risk (Calculated) -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <label>Detection Risk (Calculated)</label>
                        <span class="text-sm" id="detectionRiskValue">20.0%</span>
                    </div>
                    <div class="flex gap-4 items-center">
                        <div class="progress-bar rounded-full overflow-hidden">
                            <div id="detectionRiskBar" class="progress-fill bg-red-500" style="width: 20%"></div>
                        </div>
                        <div class="text-sm min-w-64 text-right" id="detectionRiskMessage">
                            <span class="font-bold text-red-600">HIGH extent of substantive testing</span>
                        </div>
                    </div>
                </div>

                <!-- Formula Display -->
                <div class="mt-6 p-4 bg-gray-100 rounded-lg space-y-4">
                    <p class="text-sm font-medium">Audit Risk Model Formula:</p>
                    <p class="text-blue-600 font-bold text-center">
                        Audit Risk = Inherent Risk × Control Risk × Detection Risk
                    </p>
                    <div class="flex justify-center items-center gap-4 text-sm">
                        <div class="text-center">
                            <span class="block text-gray-600">Audit Risk</span>
                            <span class="font-medium" id="formulaAuditRisk">5.0%</span>
                        </div>
                        <span class="text-xl">=</span>
                        <div class="text-center">
                            <span class="block text-gray-600">Inherent Risk</span>
                            <span class="font-medium" id="formulaInherentRisk">50.0%</span>
                        </div>
                        <span class="text-xl">×</span>
                        <div class="text-center">
                            <span class="block text-gray-600">Control Risk</span>
                            <span class="font-medium" id="formulaControlRisk">50.0%</span>
                        </div>
                        <span class="text-xl">×</span>
                        <div class="text-center">
                            <span class="block text-gray-600">Detection Risk</span>
                            <span class="font-medium" id="formulaDetectionRisk">20.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State variables
        let auditRisk = 0.05;
        let inherentRisk = 0.5;
        let controlRisk = 0.5;
        let detectionRisk = 0.2;

        // DOM elements
        const auditRiskSelect = document.getElementById('auditRisk');
        const inherentRiskSlider = document.getElementById('inherentRisk');
        const controlRiskSlider = document.getElementById('controlRisk');

        const inherentRiskValue = document.getElementById('inherentRiskValue');
        const controlRiskValue = document.getElementById('controlRiskValue');
        const detectionRiskValue = document.getElementById('detectionRiskValue');

        const inherentRiskBar = document.getElementById('inherentRiskBar');
        const controlRiskBar = document.getElementById('controlRiskBar');
        const detectionRiskBar = document.getElementById('detectionRiskBar');

        const controlRiskMessage = document.getElementById('controlRiskMessage');
        const detectionRiskMessage = document.getElementById('detectionRiskMessage');

        const formulaAuditRisk = document.getElementById('formulaAuditRisk');
        const formulaInherentRisk = document.getElementById('formulaInherentRisk');
        const formulaControlRisk = document.getElementById('formulaControlRisk');
        const formulaDetectionRisk = document.getElementById('formulaDetectionRisk');

        // Utility functions
        function formatPercentage(value) {
            return `${(value * 100).toFixed(1)}%`;
        }

        function getBarColor(value, isDetectionRisk = false) {
            if (!isDetectionRisk) {
                if (value < 0.3) return 'bg-green-500';
                if (value < 0.6) return 'bg-yellow-500';
                return 'bg-red-500';
            } else {
                if (value < 0.3) return 'bg-red-500';
                if (value < 0.6) return 'bg-yellow-500';
                return 'bg-green-500';
            }
        }

        function getDetectionRiskMessage(value) {
            if (value < 0.3) {
                return '<span class="font-bold text-red-600">HIGH extent of substantive testing</span>';
            }
            if (value < 0.6) {
                return '<span class="font-bold text-yellow-600">MODERATE extent of substantive testing</span>';
            }
            return '<span class="font-bold text-green-600">LOW extent of substantive testing</span>';
        }

        function getControlRiskMessage(value) {
            if (value >= 1) {
                return '<span class="font-bold text-red-600">CANNOT rely on controls if conclude control risk is MAXIMUM (with or without tests of operating effectiveness of controls)</span>';
            }
            if (value > 0.6) {
                return '<span class="font-bold text-red-600">LOW reliance on controls if tests of operating effectiveness indicate HIGH level of control risk</span>';
            }
            if (value > 0.3) {
                return '<span class="font-bold text-yellow-600">MODERATE reliance on controls if tests of operating effectiveness indicate MODERATE level of control risk</span>';
            }
            return '<span class="font-bold text-green-600">HIGH reliance on controls if tests of operating effectiveness indicate LOW level of control risk</span>';
        }

        // Update functions
        function calculateDetectionRisk() {
            const calculatedDetectionRisk = auditRisk / (inherentRisk * controlRisk);
            detectionRisk = Math.min(1, Math.max(0.01, calculatedDetectionRisk));
        }

        function updateDisplay() {
            // Update values
            inherentRiskValue.textContent = formatPercentage(inherentRisk);
            controlRiskValue.textContent = formatPercentage(controlRisk);
            detectionRiskValue.textContent = formatPercentage(detectionRisk);

            // Update progress bars
            inherentRiskBar.style.width = `${inherentRisk * 100}%`;
            inherentRiskBar.className = `progress-fill ${getBarColor(inherentRisk)}`;

            controlRiskBar.style.width = `${controlRisk * 100}%`;
            controlRiskBar.className = `progress-fill ${getBarColor(controlRisk)}`;

            detectionRiskBar.style.width = `${detectionRisk * 100}%`;
            detectionRiskBar.className = `progress-fill ${getBarColor(detectionRisk, true)}`;

            // Update messages
            controlRiskMessage.innerHTML = getControlRiskMessage(controlRisk);
            detectionRiskMessage.innerHTML = getDetectionRiskMessage(detectionRisk);

            // Update formula display
            formulaAuditRisk.textContent = formatPercentage(auditRisk);
            formulaInherentRisk.textContent = formatPercentage(inherentRisk);
            formulaControlRisk.textContent = formatPercentage(controlRisk);
            formulaDetectionRisk.textContent = formatPercentage(detectionRisk);
        }

        function updateCalculation() {
            calculateDetectionRisk();
            updateDisplay();
        }

        // Event listeners
        auditRiskSelect.addEventListener('change', function() {
            auditRisk = parseFloat(this.value);
            updateCalculation();
        });

        inherentRiskSlider.addEventListener('input', function() {
            inherentRisk = parseFloat(this.value) / 100;
            updateCalculation();
        });

        controlRiskSlider.addEventListener('input', function() {
            controlRisk = parseFloat(this.value) / 100;
            updateCalculation();
        });

        // Initialize
        updateCalculation();
    </script>
</body>
</html>
